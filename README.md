# Harness Feature Management and Experimentation Terraform Modules

A comprehensive, production-ready Terraform module collection for managing Harness Feature Management and Experimentation infrastructure and feature flags across multiple environments with advanced lifecycle management, safety controls, and environment-specific configurations.

## üèóÔ∏è Module Architecture

This project provides a root module that coordinates two specialized Terraform modules for comprehensive Harness Feature Management and Experimentation management:

### Root Module
The main module at the project root acts as a coordinator, consuming the local modules from the `modules/` folder based on configuration:

```hcl
# Root main.tf
module "split_administration" {
  source = "./modules/split-administration"
  count  = length(var.feature_flags) == 0 ? 1 : 0
  # Administration-only mode when no feature flags defined
}

module "feature_flags" {
  source = "./modules/split-feature-flags"  
  count  = length(var.feature_flags) > 0 ? 1 : 0
  # Feature flags mode when feature flags are defined
}
```

### Child Modules

| Module | Purpose | Key Features |
|--------|---------|--------------|
| **`split-administration`** | Infrastructure setup | Workspace, environments, traffic types, segments, API keys with environment filtering |
| **`split-feature-flags`** | Feature flag management | Feature flags with environment-specific configurations and rollout control |

### Architecture Benefits
- **Environment Filtering**: Resources only deployed to specified environments
- **Configuration Merging**: Base configurations with environment-specific overrides
- **Clean Separation**: Infrastructure and feature flag concerns separated
- **Scalable Design**: Supports multiple environments and complex configurations

## üöÄ Quick Start

### 1. Infrastructure Setup
```hcl
module "split_administration" {
  source = "./modules/split-administration"
  
  environment_name = "dev"
  workspace = { name = "MyWorkspace", create_workspace = true }
  environments = {
    dev = { name = "dev", production = false }
    prod = { name = "prod", production = true }
  }
  api_keys = [
    {
      name = "server"
      environments = ["dev", "prod"]
      environment_configs = {
        dev = { name = "dev-server" }
        prod = { name = "prod-server" }
      }
    }
  ]
}
```

### 2. Feature Flag Deployment
```hcl
module "feature_flags" {
  source = "./modules/split-feature-flags"
  
  workspace_name = "MyWorkspace"
  environment_name = "dev"
  traffic_type_name = "user"
  
  feature_flags = [
    {
      name = "new-feature"
      environments = ["dev", "staging", "prod"]
      environment_configs = {
        dev = { default_treatment = "on", rules = [{ treatment = "on", size = 100 }] }
        prod = { rules = [{ treatment = "on", size = 10 }] }
      }
    }
  ]
}
```

## ‚ú® Key Features

### Environment Safety
- **Automatic Filtering**: Feature flags only deployed to specified environments
- **Environment-Specific Configs**: Different behaviors per environment with single source of truth
- **Safe Defaults**: Conservative configurations for production environments

### Configuration Flexibility
- **Same Everywhere**: Deploy identical configurations across environments
- **Environment-Specific**: Different treatments, rules, and settings per environment
- **Environment-Only**: Features that exist only in specific environments (e.g., debug tools)

### Production Ready
- **Validation**: Comprehensive input validation with clear error messages
- **Best Practices**: Built-in security and operational patterns
- **Scalable**: Supports enterprise-scale deployments

## üìö Documentation

### English Documentation

| Category | Description | Path |
|----------|-------------|------|
| **üîß Technical** | Module architecture and advanced concepts | [`documentation/en/technical/`](documentation/en/technical/) |
| **üë• User Guide** | Implementation guides and tutorials | [`documentation/en/user/`](documentation/en/user/) |

**Start Here:**
- [Getting Started Guide](documentation/en/user/1.getting-started.md) - Complete setup and usage guide
- [Technical Architecture](documentation/en/technical/1.architecture.md) - Deep dive into module design

## üíº Use Cases

### Banking Platform Example
Complete implementation for a banking platform demonstrating:

- **Administration**: [`use-cases/banking-platform-administration/`](use-cases/banking-platform-administration/)
  - Infrastructure setup with environment-specific API keys
  - Segment management with environment filtering
  - Production-ready security configurations

- **Feature Flags**: [`use-cases/banking-platform-feature-flags/`](use-cases/banking-platform-feature-flags/)
  - Feature flags with environment-specific rollout strategies
  - Development vs. production configuration patterns
  - Safe deployment practices

## üõ°Ô∏è Environment Strategies

### Development
- **Rollout**: 100% for testing
- **Configuration**: Debug features enabled
- **Safety**: Development-only experimental features

### Staging
- **Rollout**: 50% maximum for validation
- **Configuration**: Production-like with monitoring
- **Safety**: Conservative rollout percentages

### Production
- **Rollout**: 10% maximum for new features
- **Configuration**: Optimized for performance and security
- **Safety**: Automatic rollback capabilities

## üìä Configuration Patterns

### File Structure
```
‚îú‚îÄ‚îÄ common.tfvars           # Shared configurations
‚îú‚îÄ‚îÄ environments/
‚îÇ   ‚îú‚îÄ‚îÄ development.tfvars  # Dev-specific items
‚îÇ   ‚îú‚îÄ‚îÄ staging.tfvars      # Staging-specific items
‚îÇ   ‚îî‚îÄ‚îÄ production.tfvars   # Prod-specific items
```

### Deployment Commands
```bash
# Development deployment
terraform apply \
  -var-file="common.tfvars" \
  -var-file="environments/development.tfvars"

# Production deployment  
terraform apply \
  -var-file="common.tfvars" \
  -var-file="environments/production.tfvars"
```

## üîß Requirements

- **Terraform** >= 1.5
- **Harness Feature Management and Experimentation Provider** >= 3.0
- **Harness Feature Management and Experimentation Account** with API access

## üìÑ License

This project is licensed under the MIT License.

---

# M√≥dulos de Terraform para Harness Feature Management and Experimentation

Una colecci√≥n completa de m√≥dulos de Terraform listos para producci√≥n para administrar infraestructura de Harness Feature Management and Experimentation y feature flags en m√∫ltiples entornos con gesti√≥n avanzada del ciclo de vida, controles de seguridad y configuraciones espec√≠ficas por entorno.

## üèóÔ∏è Arquitectura de M√≥dulos

Este proyecto proporciona dos m√≥dulos principales de Terraform para la gesti√≥n completa de Harness Feature Management and Experimentation:

| M√≥dulo | Prop√≥sito | Caracter√≠sticas Clave |
|--------|-----------|----------------------|
| **`split-administration`** | Configuraci√≥n de infraestructura | Workspace, entornos, tipos de tr√°fico, segmentos, API keys con filtrado por entorno |
| **`split-feature-flags`** | Gesti√≥n de feature flags | Feature flags con configuraciones espec√≠ficas por entorno y control de rollout |

### Beneficios de la Arquitectura
- **Filtrado por Entorno**: Recursos solo desplegados en entornos especificados
- **Fusi√≥n de Configuraciones**: Configuraciones base con overrides espec√≠ficos por entorno
- **Separaci√≥n Limpia**: Infraestructura y feature flags separados por responsabilidades
- **Dise√±o Escalable**: Soporta m√∫ltiples entornos y configuraciones complejas

## üöÄ Inicio R√°pido

### 1. Configuraci√≥n de Infraestructura
```hcl
module "split_administration" {
  source = "./modules/split-administration"
  
  environment_name = "dev"
  workspace = { name = "MiWorkspace", create_workspace = true }
  environments = {
    dev = { name = "dev", production = false }
    prod = { name = "prod", production = true }
  }
  api_keys = [
    {
      name = "server"
      environments = ["dev", "prod"]
      environment_configs = {
        dev = { name = "dev-server" }
        prod = { name = "prod-server" }
      }
    }
  ]
}
```

### 2. Despliegue de Feature Flags
```hcl
module "feature_flags" {
  source = "./modules/split-feature-flags"
  
  workspace_name = "MiWorkspace"
  environment_name = "dev"
  traffic_type_name = "user"
  
  feature_flags = [
    {
      name = "nueva-caracteristica"
      environments = ["dev", "staging", "prod"]
      environment_configs = {
        dev = { default_treatment = "on", rules = [{ treatment = "on", size = 100 }] }
        prod = { rules = [{ treatment = "on", size = 10 }] }
      }
    }
  ]
}
```

## ‚ú® Caracter√≠sticas Principales

### Seguridad de Entornos
- **Filtrado Autom√°tico**: Feature flags solo desplegados en entornos especificados
- **Configuraciones Espec√≠ficas por Entorno**: Diferentes comportamientos por entorno con fuente √∫nica de verdad
- **Defaults Seguros**: Configuraciones conservadoras para entornos de producci√≥n

### Flexibilidad de Configuraci√≥n
- **Igual en Todas Partes**: Desplegar configuraciones id√©nticas en todos los entornos
- **Espec√≠fico por Entorno**: Diferentes treatments, reglas y configuraciones por entorno
- **Solo por Entorno**: Caracter√≠sticas que existen solo en entornos espec√≠ficos (ej. herramientas debug)

### Listo para Producci√≥n
- **Validaci√≥n**: Validaci√≥n completa de entradas con mensajes de error claros
- **Mejores Pr√°cticas**: Patrones de seguridad y operacionales integrados
- **Escalable**: Soporta despliegues a escala empresarial

## üìö Documentaci√≥n

### Documentaci√≥n en Espa√±ol

| Categor√≠a | Descripci√≥n | Ruta |
|-----------|-------------|------|
| **üîß T√©cnica** | Arquitectura del m√≥dulo y conceptos avanzados | [`documentation/es/technical/`](documentation/es/technical/) |
| **üë• Gu√≠as de Usuario** | Gu√≠as de implementaci√≥n y tutoriales | [`documentation/es/user/`](documentation/es/user/) |

**Comience Aqu√≠:**
- [Gu√≠a de Primeros Pasos](documentation/es/user/1.primeros-pasos.md) - Gu√≠a completa de configuraci√≥n y uso
- [Arquitectura T√©cnica](documentation/es/technical/1.arquitectura.md) - An√°lisis profundo del dise√±o del m√≥dulo

## üíº Casos de Uso

### Ejemplo de Plataforma Bancaria
Implementaci√≥n completa para una plataforma bancaria que demuestra:

- **Administraci√≥n**: [`use-cases/banking-platform-administration/`](use-cases/banking-platform-administration/)
  - Configuraci√≥n de infraestructura con API keys espec√≠ficos por entorno
  - Gesti√≥n de segmentos con filtrado por entorno
  - Configuraciones de seguridad listas para producci√≥n

- **Feature Flags**: [`use-cases/banking-platform-feature-flags/`](use-cases/banking-platform-feature-flags/)
  - Feature flags con estrategias de rollout espec√≠ficas por entorno
  - Patrones de configuraci√≥n desarrollo vs. producci√≥n
  - Pr√°cticas de despliegue seguro

## üõ°Ô∏è Estrategias por Entorno

### Desarrollo
- **Rollout**: 100% para pruebas
- **Configuraci√≥n**: Caracter√≠sticas de debug habilitadas
- **Seguridad**: Caracter√≠sticas experimentales solo para desarrollo

### Staging
- **Rollout**: 50% m√°ximo para validaci√≥n
- **Configuraci√≥n**: Tipo producci√≥n con monitoreo
- **Seguridad**: Porcentajes de rollout conservadores

### Producci√≥n
- **Rollout**: 10% m√°ximo para nuevas caracter√≠sticas
- **Configuraci√≥n**: Optimizado para rendimiento y seguridad
- **Seguridad**: Capacidades de rollback autom√°tico

## üìä Patrones de Configuraci√≥n

### Estructura de Archivos
```
‚îú‚îÄ‚îÄ common.tfvars           # Configuraciones compartidas
‚îú‚îÄ‚îÄ environments/
‚îÇ   ‚îú‚îÄ‚îÄ development.tfvars  # Elementos espec√≠ficos dev
‚îÇ   ‚îú‚îÄ‚îÄ staging.tfvars      # Elementos espec√≠ficos staging
‚îÇ   ‚îî‚îÄ‚îÄ production.tfvars   # Elementos espec√≠ficos prod
```

### Comandos de Despliegue
```bash
# Despliegue desarrollo
terraform apply \
  -var-file="common.tfvars" \
  -var-file="environments/development.tfvars"

# Despliegue producci√≥n
terraform apply \
  -var-file="common.tfvars" \
  -var-file="environments/production.tfvars"
```

## üîß Requisitos

- **Terraform** >= 1.5
- **Harness Feature Management and Experimentation Provider** >= 3.0
- **Cuenta Harness Feature Management and Experimentation** con acceso API

## üìÑ Licencia

Este proyecto est√° licenciado bajo la Licencia MIT.